<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>selenium基础讲解 | Hello VuePress</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/vuepress-4/assets/css/0.styles.055c1524.css" as="style"><link rel="preload" href="/vuepress-4/assets/js/app.14484628.js" as="script"><link rel="preload" href="/vuepress-4/assets/js/2.5ff1aa65.js" as="script"><link rel="preload" href="/vuepress-4/assets/js/11.4948b4b1.js" as="script"><link rel="prefetch" href="/vuepress-4/assets/js/10.e8b177ec.js"><link rel="prefetch" href="/vuepress-4/assets/js/12.a37925d2.js"><link rel="prefetch" href="/vuepress-4/assets/js/13.96323933.js"><link rel="prefetch" href="/vuepress-4/assets/js/14.6b1ebd4f.js"><link rel="prefetch" href="/vuepress-4/assets/js/15.2c191d6d.js"><link rel="prefetch" href="/vuepress-4/assets/js/3.6a08ac1d.js"><link rel="prefetch" href="/vuepress-4/assets/js/4.6ca9c20d.js"><link rel="prefetch" href="/vuepress-4/assets/js/5.28b3b4f2.js"><link rel="prefetch" href="/vuepress-4/assets/js/6.0bb5b93e.js"><link rel="prefetch" href="/vuepress-4/assets/js/7.20d3f270.js"><link rel="prefetch" href="/vuepress-4/assets/js/8.6c5f22ef.js"><link rel="prefetch" href="/vuepress-4/assets/js/9.9ac115b6.js">
    <link rel="stylesheet" href="/vuepress-4/assets/css/0.styles.055c1524.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-4/" class="home-link router-link-active"><!----> <span class="site-name">Hello VuePress</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="selenium基础讲解"><a href="#selenium基础讲解" class="header-anchor">#</a> selenium基础讲解</h1> <p>用于网站应用的测试自动化框架。</p> <p>在使用selenium之前，简单介绍一下环境的搭建。</p> <h2 id="安装selenium"><a href="#安装selenium" class="header-anchor">#</a> 安装Selenium</h2> <p>在windows命令提示符（cmd）/Linux终端输入：</p> <p><img src="/vuepress-4/assets/img/install1.45ed863f.png" alt=""></p> <p>确保<code>pip</code>命令可用，如果提示“pip不是内部或外部命令”，需要将pip的安装目录添加到环境变量<code>path</code>下面。</p> <p>然后通过<code>pip</code>命令来安装<code>selenium</code>：<code>pip install selenium</code></p> <p><img src="/vuepress-4/assets/img/install2.4b174a23.png" alt=""></p> <h2 id="测试selenium"><a href="#测试selenium" class="header-anchor">#</a> 测试Selenium</h2> <p>在终端（前提是进入<code>Python</code>环境）或者任意一款<code>Python</code>编辑器中，输入以下内容：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.baidu.com'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>如果能正确打开谷歌浏览器并且访问百度页面，则表示安装成功。</p> <h2 id="webdriver"><a href="#webdriver" class="header-anchor">#</a> Webdriver</h2> <p><code>Webdriver</code>是一个轻便简洁的自动化测试框架，<code>Webdriver</code>利用浏览器原生的<code>API</code>，封装成一套更加面向对象的<code>SeleniumWebdriverApi</code>，直接操作浏览器页面里的元素，甚至操作浏览器本身。由于使用的是浏览器原生的<code>API</code>，速度提升，并且将环境的稳定性交给了浏览器厂商本身，更加科学。然而，不同的浏览器厂商，对<code>web</code>元素的操作和呈现多少存在差异，这就导致了<code>Webdriver</code>要分浏览器厂商的不同来驱动浏览器。</p> <h2 id="下载浏览器驱动"><a href="#下载浏览器驱动" class="header-anchor">#</a> 下载浏览器驱动</h2> <p>当<code>selenium</code>升级到3.0之后，对不同浏览器驱动进行了规范，如果想使用<code>selenium</code>驱动不同的浏览器，必须单独下载并设置不同的浏览器驱动。然后将下载好的浏览器驱动文件如：<code>C:\driver</code>，添加到环境变量中。</p> <h2 id="声明浏览器对象"><a href="#声明浏览器对象" class="header-anchor">#</a> 声明浏览器对象</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># Firefox浏览器</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># Chrome浏览器</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Ie<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># Internet Explorer浏览器</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Opera<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># Opera浏览器</span>
</code></pre></div><h2 id="介绍selenium"><a href="#介绍selenium" class="header-anchor">#</a> 介绍selenium</h2> <p><code>Selenium</code>是一组软件工具集，每一个都有不同的方法来支持测试自动化。大多数使用<code>selenium</code>的工程师，只关注一两个最能满足他们项目需求的工具。<code>selenium</code>一个最关键的特性是支持在多浏览器平台上进行测试。</p> <h3 id="selenium工具集"><a href="#selenium工具集" class="header-anchor">#</a> Selenium工具集</h3> <ul><li><p>Selenium 1（又叫Selenium RC 或 Remote Control）</p></li> <li><p>Selenium 2（又叫Selenium Webdriver）</p></li> <li><p>Selenium IDE</p></li> <li><p>Selenium-Grid</p></li></ul> <h3 id="selenium定位单个元素的方法"><a href="#selenium定位单个元素的方法" class="header-anchor">#</a> selenium定位单个元素的方法</h3> <p><code>selenium</code>提供了8种定位方式。</p> <ul><li><p>id（使用id定位）</p></li> <li><p>name（通过元素的name属性进行定位）</p></li> <li><p>class name（通过元素的class属性进行定位）</p></li> <li><p>tag name（通过元素标签名进行定位）</p></li> <li><p>link text（通过链接文字进行定位）</p></li> <li><p>partial link text（通过部分链接文字进行定位，关键字）</p></li> <li><p><a href="https://www.w3school.com.cn/xpath/xpath_syntax.asp" target="_blank" rel="noopener noreferrer">xpath<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://www.w3school.com.cn/cssref/css_selectors.asp" target="_blank" rel="noopener noreferrer">class selector<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <p>这8种定位方式在<code>Python selenium</code>中所对应的方法为：</p> <ul><li><p>find_element_by_id()</p></li> <li><p>find_element_by_name()</p></li> <li><p>find_element_by_class_name()</p></li> <li><p>find_element_by_tag_name()</p></li> <li><p>find_element_by_link_text()</p></li> <li><p>find_element_by_partial_link_text()</p></li> <li><p>find_element_by_xpath()</p></li> <li><p>find_element_by_css_selector()</p></li></ul> <h3 id="定位方法的用法"><a href="#定位方法的用法" class="header-anchor">#</a> 定位方法的用法</h3> <p>假如有一个web页面，通过前端工具查看到一个元素的属性是这样的</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">link</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#0000cc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>result_logo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onmousedown</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>return c({'fm':'tab','tab':'logo'})<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fm<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>f<span class="token punctuation">&quot;</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/s<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bg s_ipt_wr quickdelete-wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>soutu-btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>kw<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>s_ipt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>wd<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>255<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>现在我们要定位到<code>input</code>标签的输入框。</p> <ul><li>通过id定位</li></ul> <p>dr.find_element_by_id(&quot;kw&quot;)</p> <ul><li>通过name定位</li></ul> <p>dr.find_element_by_name(&quot;wd&quot;)</p> <ul><li>通过class name定位</li></ul> <p>dr.find_element_by_class_name('s_ipt')</p> <ul><li>通过tag_name定位</li></ul> <p>dr.find_element_by_tag_name('input')</p> <ul><li>通过xpath定位</li></ul> <p>dr.find_element_by_xpath('//*[@id=&quot;kw&quot;]')</p> <p>dr.find_element_by_xpath('//*[@name='wd']')</p> <p>dr.find_element_by_xpath('//input[@class='s_ipt']')</p> <p>dr.find_element_by_xpath('/html/body/form/span/input')</p> <p>dr.find_element_by_xpath(&quot;//input[@id='kw' and @name='wd']&quot;)</p> <ul><li>通过css定位</li></ul> <p>dr.find_element_by_css_selector('#kw')</p> <p>dr.find_element_by_css_selector(&quot;[name='wd']&quot;)</p> <p>dr.find_element_by_css_selector('.s_ipt')</p> <p>dr.find_element_by_css_selector(&quot;html &gt; body &gt; form &gt; span &gt; input&quot;)</p> <p>dr.find_element_by_css_selector(&quot;form#form &gt; span &gt; input&quot;)</p> <p>页面上有一组文本链接</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mnav<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://news.baidu.com<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tj_trnews<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>新闻<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mnav<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.hao123.com<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tj_trhao123<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>hao123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>通过<code>link text</code>定位</li></ul> <p>dr.find_element_by_link_text(&quot;新闻&quot;)</p> <p>dr.find_element_by_link_text(&quot;hao123&quot;)</p> <ul><li>通过<code>partial link text</code>定位</li></ul> <p>这个是上一个方法的扩展，当你不能准确知道超链接上面的文本信息或者想通过一些关键字进行匹配时，可以使用这个方法。</p> <p>dr.find_element_by_partial_link_text(&quot;新&quot;)</p> <p>dr.find_element_by_partial_link_text(&quot;hao&quot;)</p> <h3 id="定位一组元素"><a href="#定位一组元素" class="header-anchor">#</a> 定位一组元素</h3> <p>定位一组元素与定位单个元素的方法类似，唯一的区别是在<code>element</code>后面多加了一个<code>s</code>表示复数。例如：<code>find_elements_by_css_selector('.s_ipt')</code></p> <h2 id="webdriver常用方法"><a href="#webdriver常用方法" class="header-anchor">#</a> WebDriver常用方法</h2> <p>前面我们讲了如何定位元素，定位只是第一步，定位之后需要对这个元素进行一些操作，比如点击，输入等，下面认识一下WebDriver中常用的几个方法。</p> <h3 id="控制浏览器操作"><a href="#控制浏览器操作" class="header-anchor">#</a> 控制浏览器操作</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://m.baidu.com&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;设置浏览器宽480、高800显示&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>WebDriver提供了<code>set_window_size()</code>方法来设置浏览器的大小，上面的代码是将浏览器设置成移动端大小（480*800），也可以使用<code>maximize_window()</code>方法使浏览器全屏展示，使用方法同<code>set_window_size()</code>方法一样，但是它不需要参数。</p> <ul><li><p>clear()：清除文本</p></li> <li><p>send_keys()：模拟按键输入</p></li> <li><p>click()：单击事件</p></li> <li><p>submit()：提交</p></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;selenium&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;su&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><code>submit()</code>方法用于提交表单，例如，在搜索框输入关键字之后的回车操作，就可以通过该方法模拟。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

search_text <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
search_text<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'selenium'</span><span class="token punctuation">)</span>
search_text<span class="token punctuation">.</span>submit<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>有时候，<code>submit()</code>可以与<code>click()</code>方法进行互换，<code>submit()</code>同样可以提交一个按钮，但它的应用范围远不及<code>click()</code>广泛。</p> <ul><li><p>size：返回元素尺寸</p></li> <li><p>get_attribute(name)：获得属性值</p></li> <li><p>is_displayed()：该元素是否可见</p></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 获得输入框的尺寸</span>
size <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size
<span class="token keyword">print</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>

<span class="token comment"># 返回百度页面底部备案信息</span>
text <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;cp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>

<span class="token comment"># 返回元素的属性值， 可以是 id、 name、 type 或其他任意属性</span>
attribute <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>attribute<span class="token punctuation">)</span>

<span class="token comment"># 返回元素的结果是否可见， 返回结果为 True 或 False</span>
result <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>is_displayed<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="等待"><a href="#等待" class="header-anchor">#</a> 等待</h3> <p>网页常会因为网络原因，程序问题等导致打开网页慢，一直在那里转圈。当出现这种情况时网页里的很多元素就没有加载完成，如果你刚好要定位的元素没有加载完，这时程序就会抛出异常。所以在程序里面要加入必要的等待，等待元素加载完，让程序稳定运行。</p> <p>等待页面加载完成有三种方法</p> <p>1、<code>time.sleep()</code>方法</p> <p>由<code>Python</code>中的<code>time</code>模块提供，强制让代码等待xxx时间，无论前面的代码是否执行完成，都必须等待设定的时间。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 强制等待3秒</span>
sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.baidu.com/'</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>2、显示等待<code>WebDriverWait()</code></p> <p>指定一个等待条件，并且指定一个最长等待时间，直到这个元素出现就停止等待，如果没有就抛出异常。</p> <p>比如设置10秒等待时间，如果等待第4秒这个元素就出现了，那么停止等待，继续往下执行，如果第10秒元素还没有出现，就抛出异常。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC
<span class="token keyword">import</span> time

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.yuanrenxue.com'</span><span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>
      <span class="token comment"># 元素出现，只要一个符合条件的元素加载出来就通过</span>
        EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">&quot;search-show&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><code>WebDriverWait</code>和<code>ExpectedCondition</code>组合使用。在本例中，通过<code>as</code>关键字将<code>expected_conditions</code>重命名为<code>EC</code>。并调用<code>presence_of_element_located()</code>判断元素是否存在。<code>presenceOfElementLocated</code>判断是否至少一个元素存在于<code>dom</code>树中，如果页面上有<code>n</code>个元素的<code>class</code>都是<code>search-show</code>，那么只要有一个元素存在，这个方法就会返回<code>true</code>。</p> <p><code>WebDriverWait</code>类是由<code>WebDirver</code>提供的等待方法，在设置时间内，默认每隔一段时间检测一次当前页面元素是否存在，如果超过设置时间检测不到则抛出异常。具体格式如下：</p> <p>WebDriverWait（driver,timeout, poll_frequency=0.5, ignored_exceptions=None）</p> <ul><li><p>driver：浏览器驱动</p></li> <li><p>timeout ：最长超时时间，默认单位为秒</p></li> <li><p>poll_frequency ：检测的间隔（步长）时间，默认是0.5s</p></li> <li><p>ignored_exceptions ：超时后的异常信息，默认情况下抛出<code>NoSuchElementException</code>异常。</p></li></ul> <p><code>WebDriverWait()</code>一般由<code>until()</code>和<code>until_not()</code>方法配合使用。</p> <ul><li>until（method, message=‘’）</li></ul> <p>调用该方法提供的驱动程序作为一个参数，直到返回值为true，当某元素出现或者什么条件成立时执行。</p> <ul><li>until_not（method, message=‘’）</li></ul> <p>调用该方法提供的驱动程序作为一个参数，直到返回值为false，当某元素消失或者什么条件不成立时执行。</p> <p>3、隐式等待<code>implicitly_wait()</code></p> <p>隐式等待是一个全局设置，设置后所有的元素定位都会等待给定的时间，直到元素出现为止，等待规定时间内元素没有出现就会报错。</p> <p>因为设定后所有元素都要等待，所以最好用显示等待。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#等待5秒</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.yuanrenxue.com'</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'slide-left'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="获取断言信息"><a href="#获取断言信息" class="header-anchor">#</a> 获取断言信息</h3> <p>在自动化测试的过程中，需要拿实际结果与预期结果进行比较，这个比较就称为<code>断言</code>。</p> <p>我们通常可以通过获取<code>title</code>、<code>url</code>和<code>text</code>等信息进行断言。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Before search================'</span><span class="token punctuation">)</span>

<span class="token comment"># 打印当前页面title</span>
title <span class="token operator">=</span> driver<span class="token punctuation">.</span>title
<span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>

<span class="token comment"># 打印当前页面URL</span>
now_url <span class="token operator">=</span> driver<span class="token punctuation">.</span>current_url
<span class="token keyword">print</span><span class="token punctuation">(</span>now_url<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;kw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">&quot;selenium&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">&quot;su&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 强制等待一秒再执行下一步</span>
sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'After search================'</span><span class="token punctuation">)</span>

<span class="token comment"># 再次打印当前页面title</span>
title <span class="token operator">=</span> driver<span class="token punctuation">.</span>title
<span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>

<span class="token comment"># 打印当前页面URL</span>
now_url <span class="token operator">=</span> driver<span class="token punctuation">.</span>current_url
<span class="token keyword">print</span><span class="token punctuation">(</span>now_url<span class="token punctuation">)</span>

<span class="token comment"># 获取结果数目</span>
user <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'nums'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
<span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="frame-iframe定位元素"><a href="#frame-iframe定位元素" class="header-anchor">#</a> Frame/Iframe定位元素</h3> <p>在做web应用的自动化测试时，经常会遇到<code>Frame/Iframe</code>定位不到元素，<code>frame</code>中实际是嵌入了另外一个页面，而<code>Webdriver</code>每次只能在一个页面识别，因此需要定位到相应的<code>frame</code>，对那个页面的元素进行定位。</p> <p>这里常用的是<code>switch_to.frame()</code>和<code>switch_to.parent_frame()</code>，其中，如果<code>iframe</code>有<code>name</code>或者<code>id</code>的话，直接使用<code>switch_to.frame(&quot;name值&quot;)</code>或者<code>switch_to.frame(&quot;id值&quot;)</code>。父级的<code>frame</code>要查找子级的<code>frame</code>必须切换到子级的<code>frame</code>，同理子<code>frame</code>也不能查找父<code>frame</code>的元素。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> NoSuchElementException

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
url <span class="token operator">=</span> <span class="token string">'http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>  <span class="token comment"># get传入网址</span>
browser<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token string">'iframeResult'</span><span class="token punctuation">)</span>  <span class="token comment"># 切换到子frame</span>
source <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">'#draggable'</span><span class="token punctuation">)</span>  <span class="token comment"># 查找子frame中的元素</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    logo <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> NoSuchElementException<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'NO LOGO'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>default_content<span class="token punctuation">(</span><span class="token punctuation">)</span>
logo <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre></div><p>如果操作完成，可以通过<code>switch_to.parent_content()</code>方法跳出当前的<code>frame</code>，或者通过<code>switch_to.default_content()</code>跳出到最外层的页面。</p> <h3 id="下拉框选择"><a href="#下拉框选择" class="header-anchor">#</a> 下拉框选择</h3> <p>WebDriver提供了<code>select</code>类来处理下拉框</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>select <span class="token keyword">import</span> Select
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.baidu.com/'</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
setting <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_link_text<span class="token punctuation">(</span><span class="token string">u'设置'</span><span class="token punctuation">)</span>
webdriver<span class="token punctuation">.</span>ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>setting<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element_by_link_text<span class="token punctuation">(</span><span class="token string">u'高级搜索'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

s1 <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id=&quot;adv-setting-4&quot;]/select'</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

s2 <span class="token operator">=</span> Select<span class="token punctuation">(</span>s1<span class="token punctuation">)</span>
s2<span class="token punctuation">.</span>select_by_visible_text<span class="token punctuation">(</span><span class="token string">'最近一月'</span><span class="token punctuation">)</span>
sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><code>Select</code>提供了三种选择方法</p> <ul><li><p>select_by_index -- 通过选项的顺序</p></li> <li><p>select_by_value -- 通过value属性</p></li> <li><p>select_by_visible_text -- 通过可见文本</p></li></ul> <p>对应的三种取消已选择的选项为：</p> <ul><li><p>deselect_by_index</p></li> <li><p>deselect_by_visible_text</p></li> <li><p>deselect_by_value</p></li></ul> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>本文简单介绍了<code>selenium</code>的安装、测试、单个/多个元素的定位、定位方法的运用、webdriver的几种常用方法（click()、send_key()、click()、submit()）、控制浏览器的操作、等待、获取断言、下拉框选择等。</p> <h2 id="参考文章"><a href="#参考文章" class="header-anchor">#</a> 参考文章</h2> <p><a href="https://www.cnblogs.com/darwinli/p/9450488.html" target="_blank" rel="noopener noreferrer">selenium库详解及其使用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.w3school.com.cn/" target="_blank" rel="noopener noreferrer">w3school<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.yuanrenxue.com/python-selenium/selenium-waits.html" target="_blank" rel="noopener noreferrer">Python Selenium等待页面加载完成的三种方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-4/assets/js/app.14484628.js" defer></script><script src="/vuepress-4/assets/js/2.5ff1aa65.js" defer></script><script src="/vuepress-4/assets/js/11.4948b4b1.js" defer></script>
  </body>
</html>
